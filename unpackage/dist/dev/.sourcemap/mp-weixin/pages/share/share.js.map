{"version":3,"sources":["uni-app:///main.js","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?fc34","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?9703","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?ee2d","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?f16d","uni-app:///pages/share/share.vue","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?338b","webpack:////Users/yzw/my-projects/uniapp-wxml-to-canvas/pages/share/share.vue?68ca"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AAC6M;AAC7M,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAozB,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;ACex0B,2C,CAAA,I,YAAA,I,CAAA,K,YAAA,K;AACA;AACA,UADA;AAEA,MAFA,kBAEA;AACA;AACA,iBADA,EACA;AACA,sBAFA,EAEA;AACA,uBAHA;AAIA,uBAJA,EAIA;AACA,cALA;AAMA,aANA;AAOA,kBAPA;AAQA,kBARA;AASA,kBATA;AAUA,uBAVA,CAUA;AAVA;AAYA,GAfA;AAgBA,QAhBA,kBAgBA,OAhBA,EAgBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAJA,EAIA,IAJA;AAKA,OAfA;;AAiBA,GAzCA;AA0CA;AACA;AACA,kBAFA,4BAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA,EAIA,KAJA,CAIA;AACA;AACA,OANA;AAOA,KAdA;AAeA;AACA,cAhBA,wBAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCADA;AAEA,oDAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA,wCAFA;AAGA,0CAHA;;AAKA;AACA,yBAPA,MAOA;AACA;AACA,yCADA;AAEA,2CAFA;AAGA,0CAHA;;AAKA;AACA,uBAhBA;;AAkBA;AACA,iBAxBA;;AA0BA,aA3BA,MA2BA;AACA;AACA;AACA;AACA;AACA,WAnCA;;AAqCA,OAvCA;AAwCA,KA/DA;AAgEA;AACA,WAjEA,mBAiEA,YAjEA,EAiEA;AACA;AACA,wCADA;AAEA;AACA;AACA,wDADA;AAEA,iDAFA;AAGA,iDAHA;AAIA,oDAJA;AAKA;AACA;AACA;AACA,4CAFA;;AAIA,iCAVA;AAWA;AACA;AACA,iCAbA,IADA,2IAFA;;;;AAoBA;AACA;AACA,qCADA;AAEA,kCAFA;AAGA,oCAHA;;AAKA,mBA1BA,IADA;;AA6BA,KA9FA,EA1CA,E;;;;;;;;;;;;AChBA;AAAA;AAAA;AAAA;AAAy/C,CAAgB,q5CAAG,EAAC,C;;;;;;;;;;;ACA7gD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/share/share.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/share/share.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./share.vue?vue&type=template&id=69245246&scoped=true&\"\nvar renderjs\nimport script from \"./share.vue?vue&type=script&lang=js&\"\nexport * from \"./share.vue?vue&type=script&lang=js&\"\nimport style0 from \"./share.vue?vue&type=style&index=0&id=69245246&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"69245246\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/share/share.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./share.vue?vue&type=template&id=69245246&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./share.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./share.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"share-page\">\n    <view class=\"share-page-box\" id=\"box\" v-if=\"show\" :style=\"{width: canvasWidth + 'px', height: canvasHeight + 'px' }\">\n      <wxml-to-canvas class=\"widget\" :width=\"canvasWidth\" :height=\"canvasHeight\"></wxml-to-canvas>\n    </view>\n    <view class=\"share-page-box msg-box\" v-else :style=\"{width: canvasWidth + 'px', height: canvasHeight + 'px' }\">\n      {{msg}}\n    </view>\n    <view class=\"share-page-btn\" @tap=\"extraImage\">\n\t\t\t<button class=\"btn-big\" :style=\"getBtnStyle\">保存图片</button>\n    </view>\n\t\t\n  </view>\n</template>\n<script>\nconst { wxml, style } = require('./DomData.js')\nexport default {\n  name: '',\n  data () {\n    return {\n      show: false, // 是否显示canvas\n      canvasWidth: 320, // 默认canvas宽高\n      canvasHeight: 480,\n      screenWidth: null, // 设备宽度\n\t\t\tname: '',\n\t\t\tpic: '',\n\t\t\tchapter1: '',\n\t\t\tchapter2: '',\n\t\t\twidget: null,\n      msg: '加载中，请稍等...', // 提示语\n    }\n  },\n  onLoad (options) {\n    console.log('options', options);\n    this.name = 'Willam Yang'\n    this.pic = 'https://pic1.zhimg.com/80/v2-58fe538a59f870407b1435bfd45893ed_720w.jpeg'\n    this.chapter1 = '第一段'\n    this.chapter2 = '第二段'\n    \n    // 获取设备信息\n    wx.getSystemInfo({\n      success: (res) =>{\n        this.screenWidth = res.screenWidth\n\n        this.canvasWidth = this.screenWidth * 0.9\n        this.canvasHeight = this.screenWidth * 1.1\n        console.log('screenWidth', this.screenWidth)\n\n        this.show = true\n        // 数字容器宽度 动态设置 \n        setTimeout(() => {\n          wx.showLoading({title: '海报生成中...'})\n          this.widget = this.selectComponent('.widget')\n          this.renderToCanvas()\n        }, 1000)\n      }\n    });\n  },\n  methods: {\n    // wxml 转 canvas\n    renderToCanvas () {\n      console.log('this.widget', this.widget)\n      const _wxml = wxml(this.name, this.pic, this.chapter1, this.chapter2)\n      const _style = style(this.screenWidth, this.canvasWidth, this.canvasHeight)\n      const p1 = this.widget.renderToCanvas({ wxml: _wxml, style: _style })\n      p1.then((res) => {\n        console.log('海报生成成功');\n        wx.hideLoading()\n        // this.container = res\n      }).catch((err) => {\n        console.log('生成失败')\n      })\n    },\n   // 保存到朋友圈\n  extraImage() {\n    if (!this.show) {\n      wx.showToast({title: '海报生成失败，无法分享到朋友圈', icon: 'none'})\n      return\n    }\n    const p2 = this.widget.canvasToTempFilePath()\n    let that = this\n    p2.then(result => {\n      let path = result.tempFilePath\n      wx.getSetting({\n        success: res => {\n          // 非初始化且未授权的情况，需要再次弹窗提示授权\n          if (res.authSetting['scope.writePhotosAlbum'] != undefined && res.authSetting['scope.writePhotosAlbum'] != true) {\n            wx.showModal({\n              title: '是否授权相册权限',\n              content: '需要获取相册权限，请确认授权，否则无法使用相关功能',\n              success: res => {\n                if (res.confirm) {\n                  wx.openSetting({\n                    success: dataAu => {\n                      if (dataAu.authSetting[\"scope.writePhotosAlbum\"] == true) {\n                        wx.showToast({\n                          title: '授权成功',\n                          icon: 'none',\n                          duration: 1000\n                        });\n                        that.saveIMg(path);\n                      } else {\n                        wx.showToast({\n                          title: '授权失败',\n                          icon: 'success',\n                          duration: 1000\n                        });\n                      }\n                    }\n                  });\n                }\n              }\n            });\n          } else {\n            // 初始化且未授权，系统默认会弹窗提示授权\n            // 非初始化且已授权，也会进入这里\n            that.saveIMg(path);\n          }\n        }\n      });\n    })\n  },\n   // 保存到相册\n  async saveIMg (tempFilePath) {\n    wx.saveImageToPhotosAlbum({\n      filePath: tempFilePath,\n      success: async (res) => {\n        wx.showModal({\n          content: '图片已保存，分享给好友吧！',\n          showCancel: false,\n          confirmText: '好的',\n          confirmColor: '#333',\n          success: function (res) {\n            wx.navigateBack({\n              //返回\n              delta: 1\n            });\n          },\n          fail: function (res) {\n            console.log('res', res);  \n          }\n        });\n      },\n  \n      fail: function (res) {\n        wx.showToast({\n          title: '您取消了授权',\n          icon: 'none',\n          duration: 2000\n        })\n      }\n    });\n   }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.share-page {\n  background: #fff;\n  position: relative;\n  overflow: hidden;\n  min-height: 100vh;\n  .msg-box {\n    display: flex;\n    align-items: center;\n    text-align: center;\n    justify-content: center;\n  }\n  .share-page-box {\n    margin: 40rpx auto;\n    position: relative;\n    overflow: hidden;\n\t\tbox-shadow: 0rpx 6rpx 20rpx 6rpx rgba(0, 0, 0, 0.2);\n  }\n  .share-page-btn {\n    margin: 0 40rpx 50rpx;\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n</style>","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./share.vue?vue&type=style&index=0&id=69245246&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./share.vue?vue&type=style&index=0&id=69245246&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1639378884582\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}